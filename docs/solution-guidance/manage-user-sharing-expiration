---
title: Manage per user expiration for existing users on a site
description: Explains how using client side object model to change a users expiration date for sharing links
ms.date: 04/01/2020
ms.prod: sharepoint
localization_priority: Normal
---

# Manage per user expiration for existing users on a site

If you are a site administrator, you may need to [manage expiring access](https://https://support.office.com/en-us/article/manage-guest-expiration-for-a-site) for users that have access to content on your site. If your administrator has set an expiration time for access, each guest that you invite to the site or with whom you share individual files and folders will be given access for a certain number of days. If you want them to continue to have access, you must extend their access on a regular basis. There also may be times you want to change an exisiting users expiration time and that can be done via the below method. 

## Change expiration time for existing user

### Change expiration time for existing user

You can change expiration time for existing user using client side object model:

```powershell

#Grab the tenant information and credentials

param(
    [Parameter(Mandatory = $true)]
    [string] $SiteUrl,

    [Parameter(Mandatory = $true)]
    [string] $AdminUser,

    [Parameter(Mandatory=$true)]
    [securestring]$Password,
    
    [Parameter(Mandatory = $true)]
    [string] $UserEmail,
    
    [Parameter(Mandatory = $true)]
    [int] $DaysToExpiration
)

    #Context to the site
    $ctx = New-Object Microsoft.SharePoint.client.ClientContext($siteurl)
    $ctx.Credentials = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($adminuser, $password)
 
    #Get the User
    $User = $ctx.Web.SiteUsers.GetByEmail($UserEmail)
    $ctx.Load($user)
    $Ctx.ExecuteQuery()

    Write-Host "Current Expiration: $($user.Expiration)"
         
    #Update Expiration for the user
    $User.Expiration = [DateTime]::UtcNow.AddDays($DaysToExpiration).ToString("yyyy-MM-ddTHH:mm:ssZ")
    $User.Update()
    $Ctx.ExecuteQuery()

     #Get the User to check update
     $User = $ctx.Web.SiteUsers.GetByEmail($UserEmail)
     $ctx.Load($user)
     $Ctx.ExecuteQuery()

     Write-Host "New Expiration: $($user.Expiration)"
```

